---
title: "COSMOS Analysis Report"
output: html_document
params:
  minsize: NA
  method: NA
  organism: NA
  selected_kinase: NA
  selected_sample: NA
  numberKinases: NA
  sample_plot: NA
  tf_plot: NA
  network_plot: NA
  carnival_network: NA
---

COSMOS is a tool to integrate multiomic data with a prior knowledge network spanning signaling, gene regulation and metabolism ( [Dugourd et al. 2021](http://europepmc.org/abstract/MED/33502086) ). It uses the ILP formulation of CARNIVAL to connect two sets of upstream and downstream molecular features (e.i. kinase activities, TF activities, deregulated metabolites, enzyme fluxes, genetic or drug perturbations, etcâ€¦) with a signed directed transomic network. 

This resulting network is essentially a set of coherent mechanistic hypotheses that can explain how the measured deregulation may explain each other. Subsets of this network centered on user-defined nodes can be viewed in the shiny app. The network can also be downloaded as a pair of sif and attribute csv files. These files can be imported in tools such as cytoscape to visualise the full network.

### The analysis

The selected parameters:

- organism: `r params$organism`
- min size: `r params$minsize`
- solver: `r params$solver`

The code:

```{r, eval=FALSE}
  carnival_result = runCARNIVAL( inputObj = iniciators,
                                 measObj = tfList, 
                                 netObj = cNET, 
                                 weightObj = progenylist, 
                                 solverPath = solver$spath, 
                                 solver = solver$solver,
                                 timelimit = 7200,
                                 mipGAP = 0,
                                 poolrelGAP = 0 )
```

### The results

CARNIVAL produces a set of networks that can be directly visualised. 

```{r, echo=FALSE, fig.width=10}
params$carnival_network
```


A pathway enrichment analysis can be run over the results. Then, these data can be visualised on bar and volcano plots.

The heatmap provides a comprehensive overview of all contrasts/samples.
This heatmap includes the top `r params$numberKinases` selected TFs for the sample **`r params$selected_sample`** compared with the rest of the samples.

```{r, echo=FALSE, fig.width=10}
params$heatmap_plot
```

The bar plots show the activity of **`r params$selected_kinase`** for all given contrasts/samples;
and the top `r params$numberKinases` regulated TFs for sample **`r params$selected_sample`**.

```{r, echo=FALSE}
params$tf_plot

params$sample_plot
```

The interactions of `r params$selected_kinase` with its targets is shown in a network plot for sample `r params$selected_sample`.

Blue nodes indicate that the target is over-expressed and red nodes indicate that the target is down-regulated. The color of the edges represent the effect of the TF on its target (either activation or repression). The number of shown nodes can be changed by the corresponding widget.

```{r, echo=FALSE}
params$network_plot
```